<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>tokenizers æ€»ç»“ | å°è›‹å­</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="[object Object]"><meta name="designer" content="minfive"><meta name="keywords" content="NLP, æœºå™¨å­¦ä¹ , æ·±åº¦å­¦ä¹ , Python, Backend"><meta name="description" content="NLP | Machine Learning | Developer"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="https://xv44586.github.io/2022/09/08/tokenizers/index.html"><link rel="icon" type="image/png" href="/img/favicon.ico" sizes="32x32"><meta name="google-site-verification" content="tbK2z0UTHcAWdqNCgEwykaDA9vvvXnN4ZSp_LFbAbDc"><meta name="baidu-site-verification" content="NBO0j1DAOy"><meta name="baidu-site-verification" content="ulZR80nUkv"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="å°è›‹å­"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b1d2a1d2b250300950a8ffb5caa20818";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="stylesheet" href="/scss/views/page/post.css"><link rel="alternate" href="/atom.xml" title="å°è›‹å­" type="application/atom+xml"></head><body ontouchstart><div id="page-loading" class="page page-loading" style="background-image:url(/other/loading.gif)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="å°è›‹å­" alt="å°è›‹å­"><img src="/img/lg.png" alt="å°è›‹å­"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="é¦–é¡µ" title="é¦–é¡µ">é¦–é¡µ</a></li><li class="nav__item"><a href="/archives" alt="å½’æ¡£" title="å½’æ¡£">å½’æ¡£</a></li><li class="nav__item"><a href="/about" alt="å…³äº" title="å…³äº">å…³äº</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><div class="post__cover"><img src="/2022/09/08/tokenizers/cannot_code.PNG" alt="tokenizers æ€»ç»“"></div><header class="post__info"><h1 class="post__title">tokenizers æ€»ç»“</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="https://github.com/xv44586">å°è›‹å­</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2022-09-08</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/BPE/">BPE</a></li><li class="mark__item"><a href="/tags/WordPiece/">WordPiece</a></li><li class="mark__item"><a href="/tags/Unigram/">Unigram</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-eye"></i><ul class="mark__list clearfix"><li id="busuanzi_container_page_pv" class="mark__item"><span id="busuanzi_value_page_pv"></span>æ¬¡</li></ul></div></div></header><div class="post__content"><div class="toc"><ul><li><a href="#qian-yan">å‰è¨€</a><ul><li><a href="#bpe">BPE</a></li><li><a href="#bytes-bpe">Bytes BPE</a></li><li><a href="#wordpiece">WordPiece</a></li><li><a href="#unigram">Unigram</a></li><li><a href="#sentencepiece">SentencePiece</a></li><li><a href="#train-from-scratch">train from scratch</a></li></ul></li><li><a href="#tui-jian">æ¨è</a></li><li><a href="#bu-chong-yue-du">è¡¥å……é˜…è¯»</a></li><li><a href="#guan-yu-tou-tu">å…³äºå¤´å›¾</a></li></ul><p></p></div><p></p><h1><span id="qian-yan">å‰è¨€</span><a href="#qian-yan" class="header-anchor"></a></h1><p>tokenizer ç›®å‰ä¸»æµçš„æ–¹å¼æ˜¯subword levelï¼Œè‡³äºchar level /word level éƒ½ç”±äºç²’åº¦é—®é¢˜å·²è¢«ä¸»æµæŠ›å¼ƒã€‚ç›®å‰subword level çš„tokenizer BPE, Bytes BPE, WordPiece, Unigram, SentencePiece,ä¸‹é¢ç®€å•æ€»ç»“ä¸€ä¸‹å„ä¸ªæ–¹æ³•ã€‚</p><h2><span id="bpe">BPE</span><a href="#bpe" class="header-anchor"></a></h2><p>bpe çš„æ–¹æ¡ˆæ˜¯é€šè¿‡ç»Ÿè®¡è¯é¢‘æ¥ç¡®å®šä¸¤ä¸ªç›¸é‚»çš„pair subwords è¦ä¸è¦åˆå¹¶ï¼Œå…·ä½“åšæ³•ï¼š<br>1.ç»Ÿè®¡pre-tokenize çš„word çš„è¯é¢‘ï¼›<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="string">"hug"</span>, 10), (<span class="string">"pug"</span>, 5), (<span class="string">"pun"</span>, 12), (<span class="string">"bun"</span>, 4), (<span class="string">"hugs"</span>, 5)</span><br></pre></td></tr></table></figure><p></p><p>2.ä½¿ç”¨è¯å…¸å¯¹word è¿›è¡Œåˆ‡åˆ†ï¼š<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># base vocabulary: ["b", "g", "h", "n", "p", "s", "u"]</span></span><br><span class="line">(<span class="string">"h"</span> <span class="string">"u"</span> <span class="string">"g"</span>, 10), (<span class="string">"p"</span> <span class="string">"u"</span> <span class="string">"g"</span>, 5), (<span class="string">"p"</span> <span class="string">"u"</span> <span class="string">"n"</span>, 12), (<span class="string">"b"</span> <span class="string">"u"</span> <span class="string">"n"</span>, 4), (<span class="string">"h"</span> <span class="string">"u"</span> <span class="string">"g"</span> <span class="string">"s"</span>, 5)</span><br></pre></td></tr></table></figure><p></p><p>3.ç»Ÿè®¡ç›¸é‚»ä¸¤ä¸ªsubword pair è¯é¢‘ï¼Œå°†top-k é«˜çš„pair åˆå¹¶ç”Ÿæˆæ–°çš„subwordï¼Œæ·»åŠ è¿›vocabularyï¼ŒåŒæ—¶ï¼Œå¦‚æœå½“å‰çš„subword åªä¼šåŒpair ä¸€èµ·å‡ºç°ï¼Œåˆ™åŒæ—¶å°†vocabulary ä¸­å¯¹åº”subword åˆ é™¤ã€‚<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># count pair</span></span><br><span class="line">h + u = 10 + 5 = 15</span><br><span class="line">u + g = 10 + 5 +  = 20</span><br><span class="line">...</span><br><span class="line"><span class="comment"># merge top k</span></span><br><span class="line"><span class="built_in">set</span> k = 1</span><br><span class="line">ug -&gt; vocabulary</span><br><span class="line">base vocabulary: [<span class="string">"b"</span>, <span class="string">"g"</span>, <span class="string">"h"</span>, <span class="string">"n"</span>, <span class="string">"p"</span>, <span class="string">"s"</span>, <span class="string">"u"</span>, <span class="string">"ug"</span>]</span><br><span class="line">â€‹</span><br><span class="line">loop until vocabulary match vocab_size</span><br><span class="line">â€‹</span><br></pre></td></tr></table></figure><p></p><h2><span id="bytes-bpe">Bytes BPE</span><a href="#bytes-bpe" class="header-anchor"></a></h2><p>Bytes BPE ä¸BPEåŸºæœ¬ç›¸åŒï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼šBPE ä¸­ä¼šå­˜åœ¨UNK çš„æƒ…å†µï¼Œä¸ºäº†è§£å†³unk çš„é—®é¢˜ï¼Œä¸€ä¸ªéå¸¸å¤©æ‰çš„æƒ³æ³•æ˜¯å°†æ‰€æœ‰text å…ˆè½¬ä¸º<code>bytes</code> ï¼Œè¿™æ ·å°±ä¸ä¼šå­˜åœ¨unk çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨å¤šè¯­è¨€ä¸­ï¼Œè¿™ç§æ–¹å¼å¯ä»¥å¤§å¤§ç¼©å‡è¯è¡¨å¤§å°;æ­¤å¤–å³ä½¿ä¸æ˜¯ç›®æ ‡è¯­è¨€è®­ç»ƒçš„æ¨¡å‹ä¹Ÿå¯ä»¥æ‹¿æ¥ä½¿ç”¨ã€‚é€šå¸¸è¯è¡¨å¤§å°åŒ…æ‹¬256 ä¸ªåŸºæœ¬bytes + &lt;end|of|text&gt; + vocab-size,å¦‚gpt2 çš„è¯è¡¨ä¸º50257: 256 base bytes tokens + &lt;end|of|text&gt; + 50,000 merges.<br>æ­¤å¤–ï¼Œè®­ç»ƒbytes bpe æ—¶ï¼Œé€šå¸¸æˆ‘ä»¬è¿˜ä¼šé€‰æ‹©å…ˆå°†æ–‡æœ¬è¿›è¡Œnormalizeï¼Œè¿™éƒ¨åˆ†åé¢ä¼šè¿›ä¸€æ­¥è¯´æ˜ã€‚</p><h2><span id="wordpiece">WordPiece</span><a href="#wordpiece" class="header-anchor"></a></h2><p>WordPiece ä¸BPE ä¹Ÿéå¸¸ç›¸ä¼¼ï¼ŒåŒºåˆ«ä¸»è¦åœ¨äºmerge çš„ç­–ç•¥ï¼šBPE ä¸­é€‰æ‹©é¢‘ç‡æœ€é«˜çš„pair è¿›è¡Œåˆå¹¶ï¼ŒWordPiece åˆ™é€‰æ‹©ä½¿ç”¨è¯­è¨€æ¨¡å‹æ¥è¿›è¡Œé€‰æ‹©ï¼š<br>$$<br>L = logP(S) = \sum^Nlog(P_i)<br>$$<br>å¯¹äºä¸¤ä¸ªsubwordï¼š $t_x$, $t_y$ ï¼Œåˆå¹¶åä¸º $t_z$ ï¼Œåˆ™åˆå¹¶å‰åçš„å¢ç›Šï¼š<br>$$<br>Loss = logP(t_z) - (logP(t_x) + logP(t_y))<br>$$<br>é€šè¿‡è®¡ç®—åˆå¹¶å¢ç›Šæ˜¯å¦å¢å¤§æ¥å†³å®šæ˜¯å¦åˆå¹¶subword pair.</p><h2><span id="unigram">Unigram</span><a href="#unigram" class="header-anchor"></a></h2><p>Unigram ä¸ ä¸Šè¿°çš„æ–¹æ³•éƒ½ç•¥æœ‰ä¸åŒï¼šUnigram ä¸å†æ˜¯é€šè¿‡åˆå¹¶base vocabulary ä¸­çš„subword æ¥æ–°å¢ï¼Œä»–é€‰æ‹©åœ¨åˆå§‹åŒ–æ—¶åˆå§‹åŒ–ä¸€ä¸ªéå¸¸å¤§çš„subword setï¼Œé€šè¿‡è®¡ç®—æ˜¯å¦éœ€è¦å°†ä¸€ä¸ªsubword åˆ‡åˆ†ä¸ºå¤šä¸ªbase subword ï¼ˆremove è¿™ä¸ªsubwordï¼‰æ¥å‡å°vocabulary size ç›´åˆ°è¾¾åˆ°vocab sizeã€‚<br>è¿™é‡Œæœ‰ä¸€ä¸ªå‡è®¾ï¼šå¥å­ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼Œsubword ä¸ subword ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ã€‚å¯¹åº”çš„å¥å­çš„è¯­è¨€æ¨¡å‹ä¼¼ç„¶å€¼å°±æ˜¯å…¶subword çš„æ¦‚ç‡çš„ä¹˜ç§¯ã€‚ç›®æ ‡æ˜¯ä¿å­˜vocab size çš„åŒæ—¶è¯­è¨€æ¨¡å‹ä¼¼ç„¶å€¼æœ€å¤§ã€‚<br>$$<br>x^* = argmax_{x \in U}P(\overrightarrow{x})<br>$$<br>æ•´ä¸ªæ±‚è§£è¿‡ç¨‹æ˜¯ä¸€ä¸ªç®€å•çš„EM æˆ–è€…è¯´ä¸€ä¸ªè¿­ä»£è¿‡ç¨‹ï¼š<br>0.å»ºç«‹ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç§å­subword vocabularyï¼Œå¯ä»¥ç”¨å­—å…¸æ ‘æ„å»ºå¯ä»¥æ˜¯æ‰€æœ‰å­—ç¬¦çš„ç»„åˆï¼Œä¹Ÿå¯ä»¥ç”¨bpe æ„å»ºï¼›<br>1.ï¼ˆæœŸæœ›Eï¼‰ç»Ÿè®¡vocabulary ä¸­æ¯ä¸ªsubword çš„é¢‘ç‡ï¼Œè®¡ç®—å…¶å¯¹åº”æ¦‚ç‡å€¼ï¼›<br>2.ï¼ˆæœ€å¤§åŒ–Mï¼‰æ ¹æ®å…¶æ¦‚ç‡ï¼Œä½¿ç”¨ç»´ç‰¹æ¯”ç®—æ³•è¿”å›å…¶è¯­è¨€æ¨¡å‹ä¼¼ç„¶å€¼æœ€å¤§åŒ–ä¸‹çš„æœ€ä½³åˆ†å‰²æ–¹æ¡ˆï¼›<br>3.è®¡ç®—æœ€ä½³åˆ†å‰²æ–¹æ¡ˆä¸‹æ¯ä¸ªæ–°å­è¯çš„lossï¼Œè¿™é‡Œçš„loss æ˜¯æŒ‡å°†å½“å‰subword ä»vocabulary ä¸­ç§»é™¤æ—¶ï¼Œå¯¹åº”çš„è¯­è¨€æ¨¡å‹ä¼¼ç„¶å€¼ï¼Œå³<br>$$<br>L = âˆ’ \sum^Nlog (\sum_{xâˆˆS(x_i)}p(x))<br>$$<br>4.ä¸¢å¼ƒæ‰loss å‰x% å¯¹åº”çš„subwordï¼›<br>5.é‡å¤2-4é˜¶æ®µï¼Œç›´åˆ°vocabulary è¾¾åˆ°æŒ‡å®šçš„vocab sizeã€‚</p><h2><span id="sentencepiece">SentencePiece</span><a href="#sentencepiece" class="header-anchor"></a></h2><p>SentencePiece å…¶å®å¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„tokenizer æ–¹æ³•ï¼Œä»–å…¶å®æ˜¯ä¸€ä¸ªå®ç°äº†BPE/Unigram tokenizer çš„ä¸€ä¸ªé›†åˆï¼Œä¸è¿‡ä»–æœ‰ä¸€äº›åˆ›æ–°çš„åœ°æ–¹ã€‚<br>ä¸Šè¿°æ–¹æ³•ä¸­æœ‰ä¸€äº›é—®é¢˜ï¼š<br>1.éƒ½æœ‰å­—ï¼Œå­è¯æˆ–è¯çš„æ¦‚å¿µï¼Œç„¶è€Œåœ¨å¾ˆå¤šè¯­è¨€ä¸­å¹¶æ²¡æœ‰è¿™æ ·çš„æ¦‚å¿µï¼›<br>2.éƒ½é»˜è®¤éœ€è¦è‡ªå·±è¿›è¡Œpre-tokenizeï¼Œå¦‚è‹±è¯­åˆ™åˆ©ç”¨â€œç©ºæ ¼â€ä½œä¸ºè¯çš„åˆ†å‰²ç¬¦ï¼Œä¸­æ–‡åˆ™ä¸€èˆ¬é€‰æ‹©jieba è¿›è¡Œpre-tokenizeï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸åŒçš„è¯­è¨€æœ‰è‡ªå·±çš„ä¸€å¥—åšæ³•ï¼Œä¸ç»Ÿä¸€ï¼›<br>3.token æ ¼å¼ä¸ç»Ÿä¸€ã€‚ä»¥è‹±æ–‡ä¸ºä¾‹ï¼Œè¡¨ç¤ºtoken æ—¶ä¼šæœ‰ ##xx, xx/s è¿™ç§ï¼Œè¡¨ç¤ºsubword æ˜¯å¦å‡ºç°åœ¨è¯çš„é¦–å°¾ï¼Œç„¶è€Œä¸­æ–‡ä¸­æ˜¯æ²¡æœ‰è¿™ç§æ¦‚å¿µçš„ï¼›<br>4.è§£ç å›°éš¾ï¼Œå¦‚BPEè§£ç æ—¶éœ€è¦è¿›è¡Œä¸€äº›æ ‡å‡†åŒ–ï¼Œæœ€å¸¸è§çš„æ˜¯å»é™¤æ ‡ç‚¹ç¬¦å·ã€‚è€Œæˆ‘ä»¬è§£ç åæ˜¯ [new] [york]ä¸¤ä¸ªtokenï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“åŸæ¥çš„è¯æ˜¯ newyork/new york/new-york ä¸­çš„å“ªä¸€ä¸ª.<br>SentencePiece çš„åšæ³•ï¼š<br><a href="https://github.com/google/sentencepiece" target="_blank" rel="noopener"><br>SentencePiece treats the input text just as a sequence of Unicode characters. Whitespace is also handled as a normal symbol. To handle the whitespace as a basic token explicitly, SentencePiece first escapes the whitespace with a meta symbol â€œâ–â€ (U+2581) as follows.</a></p><p>å³é¦–å…ˆå°†ç©ºæ ¼è½¬æ¢ä¸ºä¸€ä¸ªæ ‡å‡†çš„å­—ç¬¦â€â–â€,ç„¶åå°†text è½¬æ¢ä¸ºunicodeï¼Œå…¶å®è¿™é‡Œçš„unicode æ˜¯NFKC-based normalizationåçš„unicodeï¼Œè‡³äºunicode æ ‡å‡†åŒ–ï¼Œå¯ä»¥å‚è€ƒ<a href="https://blog.csdn.net/weixin_43866211/article/details/98384017" target="_blank" rel="noopener">unicodeæ–‡æœ¬æ ‡å‡†åŒ–</a> ï¼Œè™½ç„¶é€šå¸¸æˆ‘ä»¬ä½¿ç”¨NFKC æ ‡å‡†åŒ–ï¼Œä½†sentencepiece å†…éƒ¨å››ç§æ–¹æ³•éƒ½å®ç°äº†ã€‚<br>é€šè¿‡ä¸Šè¿°çš„ç©ºæ ¼è½¬æ¢åŠ normalizeï¼Œæ‰€æœ‰çš„è¯­è¨€ç»è¿‡è½¬æ¢åå°±æœ‰ç»Ÿä¸€çš„æ ¼å¼äº†ï¼Œè¿™æ ·å¤šè¯­è¨€çš„é—®é¢˜å°±å½»åº•çš„ä¸token åˆ‡åˆ†è§£å¶äº†ï¼Œtokenizer å°±æœ‰äº†ä¸€ä¸ªå®Œå…¨ç«¯åˆ°ç«¯çš„è§£å†³æ–¹æ¡ˆã€‚</p><h2><span id="train-from-scratch">train from scratch</span><a href="#train-from-scratch" class="header-anchor"></a></h2><p>è®­ç»ƒä¸€ä¸ªtokenizer model ä¸»è¦æœ‰ä¸¤ä¸ªä»“åº“å¯ä»¥å‚è€ƒï¼š <a href="https://github.com/huggingface/tokenizers" target="_blank" rel="noopener">huggingface/tokenizers</a> å’Œ <a href="https://github.com/google/sentencepiece" target="_blank" rel="noopener">google/sentencepiece</a>.<br>å…¶ä¸­tokenizers æ”¯æŒbpe/bytes bpe/unigram/wordpiece, sentencepiece æ”¯æŒbpe/unigram.ä¸¤è€…éƒ½æ”¯æŒå››ç§æ ‡æ³¨åŒ–æ–¹æ³•ã€‚<br>æ­¤å¤–ï¼Œtokenizers ä¸æ”¯æŒè‡ªå®šä¹‰çš„pre_tokenizerçš„ä¿å­˜ï¼Œå¦‚ä¸­æ–‡æ—¶æˆ‘ä»¬å¸¸ç”¨çš„jieba.lcut ï¼›bytes bpeä¸æ”¯æŒbig dataset çš„è®­ç»ƒï¼Œ1T å†…å­˜è®­ç»ƒ100G æ–‡æœ¬ä¹Ÿä¼šå› å†…å­˜ä¸è¶³è¢«killedï¼Œï¼ˆä¸€ä¸ªåŠæ³•æ˜¯ç¼©å°è¯­æ–™è®­ç»ƒï¼Œå› ä¸ºæ²¡æœ‰oov çš„é—®é¢˜ï¼ŒåŸºæœ¬ä¸Šå°è¯­æ–™ä¸‹è®­ç»ƒä¹Ÿèƒ½ç”¨ï¼‰ã€‚<br>åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œé€šå¸¸ä¼šç»“åˆhuggingface/transformers ä¸€èµ·ä½¿ç”¨ï¼Œè¿™é‡Œä¹Ÿçœ‹äº†ä¸€ä¸‹transformers/tokenizers çš„å®ç°ã€‚åŸå§‹çš„GPT2 ä¸­çš„tokenizer æ˜¯æ²¡æœ‰åšnormalize çš„ï¼Œæ‰€ä»¥ transformersä¸­çš„GPT2Tokenizer ä¹Ÿæ˜¯æ²¡æœ‰åšnormalize çš„ï¼Œè€Œé€šå¸¸æˆ‘ä»¬è‡ªå·±è®­ç»ƒçš„bytes bpe æ˜¯ä¼šåŠ ä¸€ä¸ªnormalize çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥å¦‚æœæ˜¯é€šè¿‡huggingface/tokenizers è®­ç»ƒçš„tokenierï¼Œè¿ç§»åˆ°transformers æ—¶éœ€è¦æ³¨æ„normalize æ˜¯å¦å®ç°ã€‚</p><h1><span id="tui-jian">æ¨è</span><a href="#tui-jian" class="header-anchor"></a></h1><p>å½“ç›®æ ‡è¯­è¨€ä¸ºä¸­æ–‡æ—¶ï¼Œæ¨èä½¿ç”¨WordPiece + jieba çš„æ–¹æ¡ˆï¼›è€Œæ˜¯å¤šè¯­è¨€åœºæ™¯æ—¶ï¼Œæ¨èä½¿ç”¨SentencePieceBPE/SentencePieceUnigram.<br>æ— è®ºå“ªç§åˆå¹¶/åˆ‡åˆ† subword çš„ç­–ç•¥ï¼Œæˆ‘ä»¬çš„åˆè¡·æ˜¯:<br><code>å°½é‡ä¸åˆ‡åˆ†å¸¸ç”¨è¯ï¼Œè€Œæ˜¯å°†ä¸å¸¸ç”¨è¯åˆ‡åˆ†ä¸ºå¸¸ç”¨çš„å­è¯.</code><br>è€Œä¸­æ–‡ä¸­ï¼Œæœ‰æ˜ç¡®çš„å­—/è¯æ¦‚å¿µï¼Œå´æ²¡æœ‰å­è¯çš„æ¦‚å¿µï¼ˆå¦‚è‹±æ–‡ä¸­æœ‰â€appâ€, â€œ##leâ€, ä¸­æ–‡å´æ²¡æœ‰â€è‹¹â€ â€œ##æœâ€ï¼‰ï¼Œè€Œè½¬bytes åå¯¹å­è¯æ›´å‹å¥½ï¼Œæ­¤å¤–ï¼Œä¸­æ–‡é€šå¸¸éœ€è¦3ä¸ªbytesï¼ˆGBKï¼‰æˆ–è€…4ä¸ªbytesï¼ˆChinese-Japanese character setï¼‰ï¼Œå¯¹äºä¸€ä¸ªä¸­æ–‡çš„å­—ï¼Œå¾ˆæœ‰å¯èƒ½éœ€è¦å¤§äº1ä¸ªtoken æ¥è¡¨ç¤ºï¼Œåè€Œä¼šå¢åŠ tokenize ååºåˆ—çš„é•¿åº¦ï¼Œå¯¹æ¨¡å‹çš„è®­ç»ƒä¸ä½¿ç”¨ä¸åˆ©ï¼›æ­¤å¤–ï¼Œä¸­æ–‡ä¸­ç©ºæ ¼ä¹Ÿæ²¡æœ‰åˆ‡åˆ†è¯/å¥å­ çš„è¯­ä¹‰ï¼Œä¿ç•™ç©ºæ ¼åè€Œä¼šç”±äºå„ç§ç©ºæ ¼çš„é”™è¯¯ä½¿ç”¨å¸¦æ¥é—®é¢˜ï¼Œæœ€ç»ˆçš„æ¨èæ–¹æ¡ˆå°±æ˜¯jieba + Word Piece/SentencePieceUnigramã€‚<br>è€Œå¤šè¯­è¨€åœºæ™¯ä¸‹ï¼Œæ¨èä½¿ç”¨SentencePieceBPEï¼Œä»–æä¾›ä¸€ä¸ªç«¯åˆ°ç«¯çš„æ–¹æ¡ˆï¼Œè€Œä¸éœ€è¦å†æ ¹æ®ä¸åŒè¯­è¨€è¿›è¡Œä¸åŒçš„pre-tokenize/subword æ ¼å¼ï¼Œæ­¤å¤–ï¼ŒSentencePiece éƒ½æ˜¯bytes ç²’åº¦çš„ï¼Œè¿™æ ·æ—¢èƒ½å¤§å¤§ç¼©å‡è¯è¡¨åˆèƒ½é¿å…unk çš„æƒ…å†µã€‚</p><h1><span id="bu-chong-yue-du">è¡¥å……é˜…è¯»</span><a href="#bu-chong-yue-du" class="header-anchor"></a></h1><p><a href="https://huggingface.co/docs/transformers/tokenizer_summary" target="_blank" rel="noopener">tokenizer summary-huggingface</a><br><a href="https://towardsdatascience.com/difference-between-nfd-nfc-nfkd-and-nfkc-explained-with-python-code-e2631f96ae6c" target="_blank" rel="noopener">Difference Between NFD, NFC, NFKD, and NFKC Explained with Python Code-medium</a><br><a href="https://zhuanlan.zhihu.com/p/86965595" target="_blank" rel="noopener">æ·±å…¥ç†è§£NLP Subwordç®—æ³•ï¼šBPEã€WordPieceã€ULM-çŸ¥ä¹</a><br><a href="https://everdark.github.io/k9/notebooks/ml/natural_language_understanding/subword_units/subword_units.nb.html#121_expectation-maximization" target="_blank" rel="noopener">natural_language_understanding/subword_units/subword_units-github.io</a></p><h1><span id="guan-yu-tou-tu">å…³äºå¤´å›¾</span><a href="#guan-yu-tou-tu" class="header-anchor"></a></h1><p>æœ¬äººçœŸå®å†™ç…§ğŸ¶</p><div class="content-footer-sponsor"><h1><span id="sponsor">Buy me a coffee</span></h1><p>å¦‚æœè§‰å¾—è¿™ç¯‡æ–‡ç« ä¸é”™ï¼Œå¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿æ‰“èµä¸€æ¯èœœé›ªå†°åŸã€‚</p><img src="/img/sponsor.JPG" alt="logo" title="sponsor"></div><div class="post__prevs"><div class="post__prev"><a href="/2022/07/06/horovod-multi-nodes/" title="è®­ç»ƒåŠ é€Ÿç¯‡ï¼ˆ3ï¼‰horovodä¹‹å¤šæœºå¤šå¡"><i class="iconfont icon-prev"></i>è®­ç»ƒåŠ é€Ÿç¯‡ï¼ˆ3ï¼‰horovodä¹‹å¤šæœºå¤šå¡</a></div><div class="post__prev post__prev--right"><a href="/2023/01/09/zero-to-chatgpt/" title="From zero to ChatGPT">From zero to ChatGPT<i class="iconfont icon-next"></i></a></div></div></div></article><script src="https://giscus.app/client.js" data-repo="xv44586/giscus" data-repo-id="R_kgDOIC6Ipg" data-category="Announcements" data-category-id="DIC_kwDOIC6Ips4CRkmo" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="zh-CN" crossorigin="anonymous" async></script></div><aside class="page__sidebar"><form id="page-search-from" class="page__search-from" action="/search/"><label class="search-form__item"><input class="input" type="text" name="search" placeholder="Search..."> <i class="iconfont icon-search"></i></label></form><div class="sidebar__block"><h3 class="block__title">ç®€ä»‹</h3><p class="block__text">NLP | Machine Learning | Developer</p></div><div class="sidebar__block"><h3 class="block__title">æ–‡ç« åˆ†ç±»</h3><ul class="block-list"><li class="block-list-item"><a class="block-list-link" href="/categories/Programming/">Programming</a><span class="block-list-count">4</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/NLP/">NLP</a><span class="block-list-count">31</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/Math/">Math</a><span class="block-list-count">5</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/MachineLearning/">MachineLearning</a><span class="block-list-count">8</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/Life/">Life</a><span class="block-list-count">6</span></li></ul></div><div class="sidebar__block"><h3 class="block__title">æœ€æ–°æ–‡ç« </h3><ul class="block-list latest-post-list"><li class="latest-post-item"><a href="/2023/02/01/fine-tuning-at-few-shot/" title="fine-tuning-at-few-shot"><div class="item__cover"><img src="/2023/02/01/fine-tuning-at-few-shot/himalayas.JPG" alt="fine-tuning-at-few-shot"></div><div class="item__info"><h3 class="item__title">fine-tuning-at-few-shot</h3><span class="item__text">2023-02-01</span></div></a></li><li class="latest-post-item"><a href="/2023/01/09/zero-to-chatgpt/" title="From zero to ChatGPT"><div class="item__cover"><img src="/2023/01/09/zero-to-chatgpt/chatgpt-bg.jpeg" alt="From zero to ChatGPT"></div><div class="item__info"><h3 class="item__title">From zero to ChatGPT</h3><span class="item__text">2023-01-09</span></div></a></li><li class="latest-post-item"><a href="/2022/09/08/tokenizers/" title="tokenizers æ€»ç»“"><div class="item__cover"><img src="/2022/09/08/tokenizers/cannot_code.PNG" alt="tokenizers æ€»ç»“"></div><div class="item__info"><h3 class="item__title">tokenizers æ€»ç»“</h3><span class="item__text">2022-09-08</span></div></a></li><li class="latest-post-item"><a href="/2022/07/06/horovod-multi-nodes/" title="è®­ç»ƒåŠ é€Ÿç¯‡ï¼ˆ3ï¼‰horovodä¹‹å¤šæœºå¤šå¡"><div class="item__cover"><img src="/2022/07/06/horovod-multi-nodes/cat.JPG" alt="è®­ç»ƒåŠ é€Ÿç¯‡ï¼ˆ3ï¼‰horovodä¹‹å¤šæœºå¤šå¡"></div><div class="item__info"><h3 class="item__title">è®­ç»ƒåŠ é€Ÿç¯‡ï¼ˆ3ï¼‰horovodä¹‹å¤šæœºå¤šå¡</h3><span class="item__text">2022-07-06</span></div></a></li></ul></div><div class="sidebar__block"><h3 class="block__title">æ–‡ç« æ ‡ç­¾</h3><ul class="block-list tag-list clearfix"><li class="tag-item"><a class="tag-link" href="/tags/BERT/">BERT</a></li><li class="tag-item"><a class="tag-link" href="/tags/BPE/">BPE</a></li><li class="tag-item"><a class="tag-link" href="/tags/Bagging/">Bagging</a></li><li class="tag-item"><a class="tag-link" href="/tags/Boosting/">Boosting</a></li><li class="tag-item"><a class="tag-link" href="/tags/CCF/">CCF</a></li><li class="tag-item"><a class="tag-link" href="/tags/CRF/">CRF</a></li><li class="tag-item"><a class="tag-link" href="/tags/CUDA/">CUDA</a></li><li class="tag-item"><a class="tag-link" href="/tags/ChatGPT/">ChatGPT</a></li><li class="tag-item"><a class="tag-link" href="/tags/Classification/">Classification</a></li><li class="tag-item"><a class="tag-link" href="/tags/Competition/">Competition</a></li><li class="tag-item"><a class="tag-link" href="/tags/Deep-Learning/">Deep Learning</a></li><li class="tag-item"><a class="tag-link" href="/tags/Distillation/">Distillation</a></li><li class="tag-item"><a class="tag-link" href="/tags/EDA/">EDA</a></li><li class="tag-item"><a class="tag-link" href="/tags/FastBERT/">FastBERT</a></li><li class="tag-item"><a class="tag-link" href="/tags/Few-shot/">Few-shot</a></li><li class="tag-item"><a class="tag-link" href="/tags/GPT-3/">GPT-3</a></li><li class="tag-item"><a class="tag-link" href="/tags/Game/">Game</a></li><li class="tag-item"><a class="tag-link" href="/tags/Glove/">Glove</a></li><li class="tag-item"><a class="tag-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-item"><a class="tag-link" href="/tags/In-context-learning/">In-context learning</a></li><li class="tag-item"><a class="tag-link" href="/tags/LLM/">LLM</a></li><li class="tag-item"><a class="tag-link" href="/tags/LR/">LR</a></li><li class="tag-item"><a class="tag-link" href="/tags/Language-Model/">Language Model</a></li><li class="tag-item"><a class="tag-link" href="/tags/Loss/">Loss</a></li><li class="tag-item"><a class="tag-link" href="/tags/MarkDown/">MarkDown</a></li><li class="tag-item"><a class="tag-link" href="/tags/Math/">Math</a></li><li class="tag-item"><a class="tag-link" href="/tags/Matrix/">Matrix</a></li><li class="tag-item"><a class="tag-link" href="/tags/NLG/">NLG</a></li><li class="tag-item"><a class="tag-link" href="/tags/Optimizer/">Optimizer</a></li><li class="tag-item"><a class="tag-link" href="/tags/Python/">Python</a></li><li class="tag-item"><a class="tag-link" href="/tags/QA/">QA</a></li><li class="tag-item"><a class="tag-link" href="/tags/R-Drop/">R-Drop</a></li><li class="tag-item"><a class="tag-link" href="/tags/Random-Forest/">Random Forest</a></li><li class="tag-item"><a class="tag-link" href="/tags/Segmentation/">Segmentation</a></li><li class="tag-item"><a class="tag-link" href="/tags/SimCSE/">SimCSE</a></li><li class="tag-item"><a class="tag-link" href="/tags/Statistics/">Statistics</a></li><li class="tag-item"><a class="tag-link" href="/tags/Survey/">Survey</a></li><li class="tag-item"><a class="tag-link" href="/tags/T5/">T5</a></li><li class="tag-item"><a class="tag-link" href="/tags/UniLM/">UniLM</a></li><li class="tag-item"><a class="tag-link" href="/tags/Unigram/">Unigram</a></li><li class="tag-item"><a class="tag-link" href="/tags/WordPiece/">WordPiece</a></li><li class="tag-item"><a class="tag-link" href="/tags/Words-Distance/">Words Distance</a></li><li class="tag-item"><a class="tag-link" href="/tags/Xgboost/">Xgboost</a></li><li class="tag-item"><a class="tag-link" href="/tags/debug/">debug</a></li><li class="tag-item"><a class="tag-link" href="/tags/faster-decoder/">faster decoder</a></li><li class="tag-item"><a class="tag-link" href="/tags/fine-tuning/">fine-tuning</a></li><li class="tag-item"><a class="tag-link" href="/tags/horovod/">horovod</a></li><li class="tag-item"><a class="tag-link" href="/tags/multi-task/">multi-task</a></li><li class="tag-item"><a class="tag-link" href="/tags/nohup/">nohup</a></li><li class="tag-item"><a class="tag-link" href="/tags/npm/">npm</a></li><li class="tag-item"><a class="tag-link" href="/tags/simbert/">simbert</a></li><li class="tag-item"><a class="tag-link" href="/tags/skipgram/">skipgram</a></li><li class="tag-item"><a class="tag-link" href="/tags/speed-up/">speed-up</a></li><li class="tag-item"><a class="tag-link" href="/tags/swift/">swift</a></li><li class="tag-item"><a class="tag-link" href="/tags/tensorflow-gpu/">tensorflow-gpu</a></li><li class="tag-item"><a class="tag-link" href="/tags/word2vec/">word2vec</a></li><li class="tag-item"><a class="tag-link" href="/tags/ä¿¡æ¯ç†µ/">ä¿¡æ¯ç†µ</a></li><li class="tag-item"><a class="tag-link" href="/tags/æ–°è¯å‘ç°/">æ–°è¯å‘ç°</a></li><li class="tag-item"><a class="tag-link" href="/tags/æ ·æœ¬ä¸å‡è¡¡/">æ ·æœ¬ä¸å‡è¡¡</a></li><li class="tag-item"><a class="tag-link" href="/tags/è£…æœº/">è£…æœº</a></li><li class="tag-item"><a class="tag-link" href="/tags/é¢†åŸŸè¯æŒ–æ˜/">é¢†åŸŸè¯æŒ–æ˜</a></li></ul></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">å…³äº</h3><div class="item__content"><p class="item__text">æœ¬ç«™æ˜¯åŸºäº Hexo æ­å»ºçš„é™æ€èµ„æºåšå®¢ï¼Œä¸»è¦ç”¨äºåˆ†äº«æ—¥å¸¸å­¦ä¹ ã€ç”Ÿæ´»åŠå·¥ä½œçš„ä¸€äº›å¿ƒå¾—æ€»ç»“ã€‚</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>Beijing, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>xv44586@gmail.com</span></li></ul></div></div><div class="footer-top__item"><h3 class="item__title">å‹æƒ…é“¾æ¥</h3><div class="item__content"><ul class="footer-top__list"><li class="list-item"><a href="http://www.matrix67.com/" title="Matrix67" target="_blank">Matrix67</a></li><li class="list-item"><a href="https://spaces.ac.cn/" title="Spaces" target="_blank">ç§‘å­¦ç©ºé—´</a></li></ul></div></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><p class="footer__copyright">Â© <a href="https://github.com/Mrminfive/hexo-theme-skapp" target="_blank">Skapp</a> 2017 powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, made by <a href="https://github.com/Mrminfive" target="_blank">minfive</a>. modified by <a href="https://github.com/xv44586" target="_blank">å°è›‹å­</a></p><ul class="footer__social-network clearfix"><li class="social-network__item"><a href="https://github.com/xv44586" target="_blank" title="github"><i class="iconfont icon-github"></i></a></li><li class="social-network__item"><a href="xv44586@gmail.com" target="_blank" title="email"><i class="iconfont icon-email"></i></a></li></ul></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
                processEscapes: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
            });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
                for (i=0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
                }
            });</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>